function hands = CS5320_edge_method(im)
% CS5320_hands - find hands of surrender in image
% On input:
%       im (mxn array): image
% On output:
%       hands (mxnx3 array): rgb image of original with hands outlined
%       in red
% Call:
%       hands = CS5320_edge_method(s1g);
% Author:
%       Shantnu Kakkar
%       UU
%       Spring 2016

hands = cat(3, im, im, im);

% % Uncomment the method of edge formation 
% that you want to use. By default laplacian has 
% been used.

%%Edge image via sobel
% im = edge(im,'sobel');

%%Edge image via zerocross 
% H = fspecial('gaussian',5,2);
% im = filter2(H,im);
% im = edge(im,'zerocross');

%%Edge image via laplacian
G = fspecial('gaussian',1,1);
lap = fspecial('laplacian',1);
loG = filter2(lap,G);
im = filter2(loG,im);
im = edge(im,'loG');


T = [0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0,0.0625000000000000,0.0625000000000000,0,0,0,0,0,0,0,0,0,0;0,0,0,0,0,0,0.187500000000000,0.250000000000000,0.187500000000000,0.0625000000000000,0.0625000000000000,0,0,0,0,0,0,0,0;0,0,0,0,0.0625000000000000,0.250000000000000,0.0625000000000000,0.187500000000000,0.0625000000000000,0.312500000000000,0.0625000000000000,0.187500000000000,0,0,0,0,0,0,0;0,0,0,0,0.125000000000000,0.250000000000000,0.0625000000000000,0,0.187500000000000,0.250000000000000,0.125000000000000,0,0.0625000000000000,0.125000000000000,0,0,0,0,0;0,0,0,0,0.125000000000000,0.312500000000000,0.187500000000000,0.250000000000000,0.312500000000000,0.437500000000000,0.187500000000000,0,0.187500000000000,0.125000000000000,0,0,0,0,0;0,0,0,0,0.250000000000000,0.0625000000000000,0.375000000000000,0.250000000000000,0.312500000000000,0.312500000000000,0.187500000000000,0.125000000000000,0,0.125000000000000,0.125000000000000,0,0,0,0;0,0,0,0,0.250000000000000,0.187500000000000,0.125000000000000,0.125000000000000,0.187500000000000,0.312500000000000,0.187500000000000,0.312500000000000,0.0625000000000000,0.250000000000000,0,0,0,0,0;0,0,0,0.125000000000000,0.250000000000000,0.250000000000000,0.187500000000000,0.0625000000000000,0.125000000000000,0.250000000000000,0.0625000000000000,0,0.187500000000000,0.125000000000000,0,0,0,0,0;0,0,0,0.0625000000000000,0.312500000000000,0.125000000000000,0.312500000000000,0.0625000000000000,0.125000000000000,0.250000000000000,0.0625000000000000,0,0.187500000000000,0.0625000000000000,0,0,0,0,0;0,0,0,0.0625000000000000,0.312500000000000,0.0625000000000000,0.250000000000000,0,0.125000000000000,0.375000000000000,0,0,0.187500000000000,0.187500000000000,0.0625000000000000,0,0,0,0.0625000000000000;0,0,0,0.187500000000000,0.125000000000000,0.187500000000000,0.125000000000000,0.125000000000000,0.125000000000000,0.187500000000000,0.125000000000000,0,0.187500000000000,0.250000000000000,0.0625000000000000,0,0,0,0.125000000000000;0,0,0.0625000000000000,0.0625000000000000,0.125000000000000,0.250000000000000,0.125000000000000,0.125000000000000,0.125000000000000,0.125000000000000,0.187500000000000,0.312500000000000,0.187500000000000,0.187500000000000,0,0,0,0,0.125000000000000;0,0,0.0625000000000000,0.0625000000000000,0.125000000000000,0.187500000000000,0.187500000000000,0.250000000000000,0.0625000000000000,0.250000000000000,0.250000000000000,0.437500000000000,0.125000000000000,0.125000000000000,0.0625000000000000,0,0,0,0.125000000000000;0,0,0.0625000000000000,0.125000000000000,0.125000000000000,0.0625000000000000,0.187500000000000,0.250000000000000,0.125000000000000,0.187500000000000,0.0625000000000000,0.437500000000000,0.125000000000000,0.187500000000000,0.0625000000000000,0,0,0,0;0,0,0.0625000000000000,0.187500000000000,0.0625000000000000,0.125000000000000,0.187500000000000,0.312500000000000,0.0625000000000000,0.250000000000000,0.125000000000000,0.437500000000000,0.0625000000000000,0.0625000000000000,0.250000000000000,0.0625000000000000,0,0,0;0.0625000000000000,0,0.0625000000000000,0.125000000000000,0.125000000000000,0.125000000000000,0.250000000000000,0.500000000000000,0.125000000000000,0.437500000000000,0.187500000000000,0.312500000000000,0.125000000000000,0.125000000000000,0.187500000000000,0.0625000000000000,0,0,0.0625000000000000;0.0625000000000000,0,0,0.187500000000000,0.187500000000000,0.312500000000000,0.125000000000000,0.250000000000000,0.125000000000000,0.187500000000000,0.125000000000000,0.375000000000000,0.187500000000000,0.187500000000000,0.0625000000000000,0.187500000000000,0,0,0.125000000000000;0.0625000000000000,0,0,0.250000000000000,0.125000000000000,0.312500000000000,0.312500000000000,0.125000000000000,0.0625000000000000,0.250000000000000,0.0625000000000000,0.250000000000000,0.125000000000000,0.187500000000000,0.125000000000000,0.0625000000000000,0.187500000000000,0.125000000000000,0.0625000000000000;0.0625000000000000,0.0625000000000000,0.0625000000000000,0.250000000000000,0.187500000000000,0.375000000000000,0.187500000000000,0.125000000000000,0.125000000000000,0.187500000000000,0.0625000000000000,0.187500000000000,0.125000000000000,0.187500000000000,0.125000000000000,0,0,0.187500000000000,0.0625000000000000;0.125000000000000,0.125000000000000,0.187500000000000,0.125000000000000,0.125000000000000,0.250000000000000,0.250000000000000,0.0625000000000000,0.187500000000000,0.0625000000000000,0.0625000000000000,0.187500000000000,0,0.250000000000000,0.187500000000000,0,0.0625000000000000,0.125000000000000,0.125000000000000;0.125000000000000,0,0.187500000000000,0.187500000000000,0.125000000000000,0.187500000000000,0.187500000000000,0.187500000000000,0.187500000000000,0.0625000000000000,0.187500000000000,0.0625000000000000,0,0.187500000000000,0.250000000000000,0.0625000000000000,0.0625000000000000,0,0.187500000000000;0.250000000000000,0.125000000000000,0.375000000000000,0.187500000000000,0,0.0625000000000000,0.375000000000000,0.0625000000000000,0.250000000000000,0.125000000000000,0.250000000000000,0,0.125000000000000,0.0625000000000000,0.125000000000000,0.250000000000000,0.0625000000000000,0.0625000000000000,0.187500000000000];
% T = edge(T,'sobel');
% load('UniversalTemplate');
[num_rows_T , num_cols_T] = size(T);
[num_rows_IM , num_cols_IM] = size(im);

C =  CS5320_normcorr_withMean(T,im);
for i = 1: num_rows_IM 
    for j = 1:num_cols_IM 
         if C(i,j)>0.26
             hands(i,j,1) = 256;
             hands(i,j,2) = 0;
             hands(i,j,3) = 0;
         end
    end
end

% Uncomment below to see the edge image, 
%edge tepmlate and the original image with red hands
% figure; imshow(im);
% figure; imshow(T);
% figure; imshow(hands);
